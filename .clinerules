# Project Wiki & Knowledge Base Rules

## Documentation Source of Truth (SSOT)
The directory `00_active_specs/` is the designated **Wiki** and **Single Source of Truth** for this project.
- **Index**: `00_active_specs/README.md` is the entry point.
- **Scope**: It contains the Architecture, Core Components, Runtime Behaviors, and Protocols.

## Automatic Referencing Instructions
1.  **ALWAYS Check Specs First**: When the user asks about project architecture, features, data structures, or workflows, you MUST mentally (or via tools) consult the relevant files in `00_active_specs/` BEFORE answering.
2.  **Do Not Guess**: Do not hallucinate or guess implementation details if they are defined in `00_active_specs/`.
3.  **Context Awareness**: Be aware that the user considers `00_active_specs/` as the active context. If you need to "remember" how a specific module works (e.g., Mnemosyne, Jacquard), read the corresponding file in that directory.

## Directory Map & Key Files

### 1. Overview & Vision (Root Level)
- `vision-and-philosophy.md`: Core design philosophy ("The Caesar Principle").
- `architecture-principles.md`: Core architecture principles and design decisions.
- `metaphor-glossary.md`: Terminology and metaphor system.

### 2. Subsystems (Domain-based Organization)
- `infrastructure/README.md`: Base services, DI, and cross-platform abstraction.
- `jacquard/README.md`: **The Loom** - Orchestration, Pipeline, and Plugins.
- `mnemosyne/README.md`: **Mnemosyne** - Data Engine overview and logic.
- `presentation/README.md`: **The Stage** - UI/UX and Flutter implementation.
- `muse/README.md`: Muse Intelligence Service - Agent hosting and LLM gateway.

### 3. Jacquard Components
*Specific implementation details for the Orchestration Engine.*
- `jacquard/planner-component.md`: Pre-Flash Planner, Triage, and Focus Management.

### 4. Data Storage & Schema
*Specific implementation details for the Data Engine.*
- `mnemosyne/sqlite-architecture.md`: SQL Schema definitions.
- `mnemosyne/abstract-data-structures.md`: In-memory data structures.
- `mnemosyne/hybrid-resource-management.md`: Hybrid resource management and Asset protocol.

### 5. Runtime Dynamics
- `runtime/layered-runtime-architecture.md`: Session management, state patching, and layers (L0-L3).

### 6. Protocols & Formats
- `protocols/filament-protocol-overview.md`: The unified interaction protocol.
- `protocols/filament-input-format.md`: XML+YAML input specs.
- `protocols/filament-output-format.md`: XML+JSON output specs.
- `protocols/jinja2-macro-system.md`: Template engine and macros.
- `protocols/schema-library.md`: Schema library specifications.
- `protocols/filament-parsing-workflow.md`: Filament parsing workflow.

### 7. Workflows
- `workflows/prompt-processing.md`: The complete prompt generation pipeline.
- `workflows/character-import-migration.md`: Logic for importing/migrating character cards.
- `workflows/migration-strategy.md`: Strategic approach to migration.

### 8. References
- `reference/documentation_standards.md`: Documentation writing and checking guidelines.
- `reference/macro-system-spec.md`: Macro system specification (Clotho/Jinja2).
- `reference/st-macro-reference.md`: SillyTavern macro reference.
- `reference/acu-architecture-analysis.md`: ACU architecture analysis.
- `reference/legacy/`: Legacy documentation and archives.
